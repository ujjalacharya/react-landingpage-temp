1
00:00:00,900 --> 00:00:01,230
Right.

2
00:00:01,240 --> 00:00:08,200
So now after after they complete a transaction I want to send that email to the user saying OK thanks.

3
00:00:08,260 --> 00:00:09,930
Thank you for purchasing.

4
00:00:09,940 --> 00:00:12,600
You know for buying wheedles or shopping with us something like that.

5
00:00:12,760 --> 00:00:15,940
And here here you get the order number.

6
00:00:15,990 --> 00:00:17,650
That's what we want to do.

7
00:00:17,650 --> 00:00:25,090
Of course we can already have this would send the e-mail and it's going to be really simple but we get

8
00:00:25,090 --> 00:00:28,370
just one tiny problem right now.

9
00:00:28,370 --> 00:00:35,020
Of course we are storing everything in our Mogo instance and everything is OK.

10
00:00:35,020 --> 00:00:35,400
All right.

11
00:00:35,410 --> 00:00:40,290
So right here just like we did before we will you know send the mail.

12
00:00:40,510 --> 00:00:46,390
Now we need to instruct the mail what needs to be rendered you know what are the purchase orders or

13
00:00:46,390 --> 00:00:52,960
the purchase order and a little bit more detail and what they are or what they bought when we why they

14
00:00:52,960 --> 00:00:53,460
are buying.

15
00:00:53,470 --> 00:00:56,740
Maybe one guitar maybe two guitars or whatever.

16
00:00:57,040 --> 00:01:02,530
So we can a need to run that function to send email function but we need to pass some arguments.

17
00:01:02,590 --> 00:01:04,550
All the information about the purchase.

18
00:01:04,690 --> 00:01:12,070
Right now if we go to the mail function right here you have to have the name we have the token the template.

19
00:01:12,280 --> 00:01:13,470
So we don't have.

20
00:01:13,690 --> 00:01:19,030
So far we don't have anything that you know passes some information to the actual template.

21
00:01:19,090 --> 00:01:20,740
So we will need to add it.

22
00:01:20,770 --> 00:01:21,510
All right.

23
00:01:21,730 --> 00:01:26,140
So we're going to go to the server going to start doing this right here.

24
00:01:26,170 --> 00:01:29,460
So on the server we need to of course go to this function.

25
00:01:29,620 --> 00:01:33,420
And if you remember it sent e-mail open and close.

26
00:01:33,490 --> 00:01:37,920
Now we need to pass the user e-mail and right here at the top.

27
00:01:38,080 --> 00:01:43,450
Just want to show you because it's a little bit confusing on the first one the first find one update

28
00:01:43,660 --> 00:01:46,310
whenever we find a user we get the user back.

29
00:01:46,450 --> 00:01:48,840
So I'm going to make reference to this user.

30
00:01:49,270 --> 00:01:49,860
Right.

31
00:01:49,870 --> 00:01:51,140
So send e-mail.

32
00:01:51,190 --> 00:01:55,090
We make reference to user and then e-mail that we need the name.

33
00:01:55,090 --> 00:02:01,140
So it's user up user dot name than a coma.

34
00:02:01,300 --> 00:02:06,260
The second argument on our function was a token we are not using a token.

35
00:02:06,280 --> 00:02:08,920
So we say no then it coma.

36
00:02:09,040 --> 00:02:10,600
What is the name of the template.

37
00:02:10,600 --> 00:02:13,990
We didn't have the template template but we're going to create it in a minute.

38
00:02:14,050 --> 00:02:16,570
So this one is going to be called purchase.

39
00:02:16,570 --> 00:02:18,290
You can call this whatever you want.

40
00:02:18,760 --> 00:02:25,130
So the last argument is going to be the transduction data or the actual information about the you know

41
00:02:25,130 --> 00:02:26,410
the purchase.

42
00:02:26,410 --> 00:02:31,450
So if I scroll right here to the top we get the transaction data.

43
00:02:31,480 --> 00:02:37,000
And this is what we are storing instead of the payment model.

44
00:02:37,000 --> 00:02:37,490
Right.

45
00:02:37,660 --> 00:02:42,390
So I got a copy transduction data and I'm going to be passing pretty much all of course later.

46
00:02:42,410 --> 00:02:44,820
We're going to we're going to get out of here.

47
00:02:44,830 --> 00:02:46,280
The only things we need.

48
00:02:46,450 --> 00:02:46,910
OK.

49
00:02:47,170 --> 00:02:48,460
So transduction data.

50
00:02:48,460 --> 00:02:54,760
So now this function this sent e-mail will be expecting a new argument right here.

51
00:02:54,970 --> 00:02:58,810
So of course we need to specify what we are expecting.

52
00:02:58,810 --> 00:02:59,250
All right.

53
00:02:59,440 --> 00:03:05,260
So on the sent email going to do coma I'm going to say act transaction data could be action date.

54
00:03:05,270 --> 00:03:12,280
I get called Action data right here and this one of course by default sometimes you're not going to

55
00:03:12,280 --> 00:03:13,690
get this at all.

56
00:03:13,690 --> 00:03:19,100
So I'm going to say by default it's not just in case you can do this with the access Isak's.

57
00:03:19,420 --> 00:03:25,450
So I'm going to go right here at the top of the bottom and whenever we make of reference to the function

58
00:03:25,660 --> 00:03:31,870
to get the template we're going to say transaction data or sexually action data and begin to be you

59
00:03:31,870 --> 00:03:35,550
know passing the argument to this function at the top.

60
00:03:35,560 --> 00:03:39,690
Now the function of the top of course will be getting that actual data.

61
00:03:39,730 --> 00:03:41,970
And now we need to create a new template.

62
00:03:42,060 --> 00:03:46,240
Ryan I'm going to copy this one because it looks pretty much the same.

63
00:03:46,630 --> 00:03:50,470
So the case it's purchase.

64
00:03:50,470 --> 00:03:50,960
All right.

65
00:03:50,970 --> 00:03:57,230
Portus still from waves and you know ways the two we got the two.

66
00:03:57,370 --> 00:03:59,700
The subject could be.

67
00:03:59,800 --> 00:04:03,590
Thanks for shopping with us something like that.

68
00:04:04,030 --> 00:04:08,960
Thanks for shopping with us.

69
00:04:09,040 --> 00:04:11,660
And then the name why not.

70
00:04:11,830 --> 00:04:16,280
Now we need to make a reference to a new template we cannot use the welcome.

71
00:04:16,330 --> 00:04:21,890
So I'm going to call this purchase and inside of the purchase will be passing.

72
00:04:21,900 --> 00:04:25,100
We will be passing whatever we get from the actual data.

73
00:04:25,290 --> 00:04:29,020
So make it right to get a copy and then paste it.

74
00:04:29,020 --> 00:04:32,220
We don't have the template it created right now.

75
00:04:32,260 --> 00:04:38,890
So of course we're going to parse the BDO bring the purchase template that each team will get it from

76
00:04:38,900 --> 00:04:39,960
resources.

77
00:04:40,030 --> 00:04:40,630
Right.

78
00:04:40,660 --> 00:04:44,540
And they begin to create Deeya jazz for that template.

79
00:04:44,560 --> 00:04:44,820
OK.

80
00:04:44,830 --> 00:04:48,290
So this is the purchased template This is how it looks.

81
00:04:48,290 --> 00:04:53,470
It's pretty much like the other one pretty much you know same welcome to waves or same Hetter we're

82
00:04:53,470 --> 00:04:54,810
going to changes of course.

83
00:04:55,000 --> 00:04:57,650
And it's your purchase information.

84
00:04:57,700 --> 00:05:02,300
I've added a T row and each side of the information outside the purchase information.

85
00:05:02,300 --> 00:05:08,570
You know after the H2 tag we get with you know all the products we get from the data.

86
00:05:08,600 --> 00:05:09,070
Right.

87
00:05:09,230 --> 00:05:10,130
Real simple.

88
00:05:10,190 --> 00:05:12,010
So we're going to use this one.

89
00:05:12,050 --> 00:05:12,800
OK.

90
00:05:13,070 --> 00:05:14,370
So what are we going to do there.

91
00:05:14,390 --> 00:05:14,670
OK.

92
00:05:14,690 --> 00:05:17,930
So we need to create the jails for this.

93
00:05:17,930 --> 00:05:24,360
So it's going to be a new file and then purchase underscore template.

94
00:05:24,490 --> 00:05:26,590
Yes real simple.

95
00:05:26,840 --> 00:05:31,010
So just like the welcome this is just a function that we get exported.

96
00:05:31,010 --> 00:05:38,210
So it's Konst purchase equals and then we run a function.

97
00:05:38,330 --> 00:05:41,840
Remember that this one will be getting some data back.

98
00:05:41,840 --> 00:05:42,680
Right.

99
00:05:42,770 --> 00:05:44,930
And then of course we need to export this.

100
00:05:44,960 --> 00:05:55,350
So I'm going to go and say module dad exports equal and then purchase you know same name purchase.

101
00:05:55,550 --> 00:05:56,580
Right.

102
00:05:57,330 --> 00:06:01,500
So now of course we need to include this template from within the mail.

103
00:06:01,670 --> 00:06:10,730
So I'm going to go with the mail and say Konst opening close then purchased and we acquired this from

104
00:06:10,730 --> 00:06:11,760
the correct place.

105
00:06:11,780 --> 00:06:17,850
So require that forward slash and then purchase template.

106
00:06:18,040 --> 00:06:19,400
Yes.

107
00:06:19,460 --> 00:06:19,900
All right.

108
00:06:20,120 --> 00:06:23,890
So now purchase of course exists and we are passing the data.

109
00:06:24,020 --> 00:06:24,840
All right.

110
00:06:24,860 --> 00:06:26,580
So let's go to the purchase template.

111
00:06:26,810 --> 00:06:37,140
Now of course we will get a tiny tiny tiny proem not whenever we for example if we make a transaction

112
00:06:37,140 --> 00:06:44,190
right here we could be buying just one guitar but we could buy many guitars.

113
00:06:44,250 --> 00:06:50,510
So you need to tell specify right here what are we buying when we go to the purchase template.

114
00:06:50,520 --> 00:06:51,660
So right here we get one.

115
00:06:51,660 --> 00:06:53,350
But what happens if you get two.

116
00:06:53,490 --> 00:06:57,260
So you will need to go one than two than three.

117
00:06:57,270 --> 00:07:02,160
And you know all the products they purchase or there it's going to be the same because we get only one

118
00:07:02,160 --> 00:07:04,320
purchase or purchase section.

119
00:07:04,320 --> 00:07:09,880
But in this case what we will need to do is to create a loop through that data and show everything right

120
00:07:09,900 --> 00:07:10,470
here.

121
00:07:10,470 --> 00:07:14,890
So for now just going to go back to the way it was.

122
00:07:16,080 --> 00:07:16,520
All right.

123
00:07:17,600 --> 00:07:18,760
There we go.

124
00:07:19,670 --> 00:07:25,550
So I'm going to pretty much copy the whole template and I'm going to go back to our purchase template.

125
00:07:25,700 --> 00:07:30,940
Remember that at the end of this function we always return a template string.

126
00:07:30,950 --> 00:07:36,930
So inside of the template string I'm going to copy paste and format this a little bit better.

127
00:07:37,100 --> 00:07:38,270
All right.

128
00:07:38,690 --> 00:07:47,980
Now what are we going to be doing is that after the H2 tag going to this and make a reference to a function.

129
00:07:48,080 --> 00:07:48,530
Right.

130
00:07:48,530 --> 00:07:52,310
Because we want to loop something and we cannot really do it from here.

131
00:07:52,310 --> 00:07:54,410
So I'm going to say get items.

132
00:07:54,530 --> 00:07:58,020
This is going to be the name of my function you can call this whatever you want.

133
00:07:58,340 --> 00:07:58,960
All right.

134
00:07:59,120 --> 00:08:04,700
So I'm going to go at the top before the return and we will create a function that takes the data and

135
00:08:04,700 --> 00:08:05,460
loops everything.

136
00:08:05,470 --> 00:08:13,330
So cons get items is just a function that returns something are going to create a template that for

137
00:08:13,340 --> 00:08:14,890
now it's equal to nothing.

138
00:08:14,900 --> 00:08:16,350
It could be equal to no.

139
00:08:16,370 --> 00:08:20,160
If you wish and that of course we need to loop.

140
00:08:20,300 --> 00:08:25,490
And at the very end return we return the template.

141
00:08:25,520 --> 00:08:27,890
Right now let's create the loop.

142
00:08:27,890 --> 00:08:29,540
Really really simple.

143
00:08:30,090 --> 00:08:30,680
OK.

144
00:08:31,190 --> 00:08:35,300
So first we enter data the data right here the top.

145
00:08:35,300 --> 00:08:39,630
Then if you remember that data on whenever we store it.

146
00:08:40,030 --> 00:08:45,920
Let me just show you right here whenever we store something we get a user a data in a product.

147
00:08:46,250 --> 00:08:51,410
So the one we need right now it's the product all the products that the user it's buying.

148
00:08:51,410 --> 00:08:51,950
Right.

149
00:08:52,130 --> 00:08:52,550
OK.

150
00:08:52,700 --> 00:08:58,610
So we do data that product dot for each.

151
00:08:59,120 --> 00:09:03,990
I'm just going to run for each if you want to do a for loop that is OK.

152
00:09:04,250 --> 00:09:08,400
So on each iteration we get an item and then we just loop it.

153
00:09:08,570 --> 00:09:09,290
What are we going to do.

154
00:09:09,290 --> 00:09:15,200
We can grab the template and we can concatenate everything to that template.

155
00:09:15,260 --> 00:09:20,080
And what we do which is you use template strings and the code we're going to be using.

156
00:09:20,080 --> 00:09:23,440
It's pretty much really the one we have on the template that's one.

157
00:09:23,570 --> 00:09:25,140
So we could attach this dev.

158
00:09:25,150 --> 00:09:27,540
And let me make sure maybe I did it incorrectly.

159
00:09:27,710 --> 00:09:31,090
Let me go to purchase H2.

160
00:09:31,160 --> 00:09:32,390
Okay that's good.

161
00:09:32,690 --> 00:09:39,390
So we attach a depth each guitar for example if you get two guitars we can get two deps with the information

162
00:09:39,400 --> 00:09:39,740
inside.

163
00:09:39,750 --> 00:09:46,370
So I going to copy the div go right here at the top and paste it inside and I'm going to make it a little

164
00:09:46,370 --> 00:09:48,460
bit better because it's really ugly.

165
00:09:49,580 --> 00:09:56,190
Well you know sometimes the format not that nice.

166
00:09:56,190 --> 00:09:56,430
All right.

167
00:09:56,430 --> 00:09:59,370
Let me correct this a little bit better.

168
00:10:01,460 --> 00:10:02,250
Just a little bit.

169
00:10:02,260 --> 00:10:02,860
OK.

170
00:10:03,350 --> 00:10:04,700
So we have a name.

171
00:10:04,970 --> 00:10:08,000
We have a price and we have the purchase order.

172
00:10:08,000 --> 00:10:13,590
Now if you remember we need to access the item I'm going to say item.

173
00:10:13,930 --> 00:10:14,790
Paste.

174
00:10:15,010 --> 00:10:17,900
And then space and again to add the name.

175
00:10:17,930 --> 00:10:23,770
So first it's the brand and then the name so item dot name.

176
00:10:23,840 --> 00:10:26,750
So the brand of the guitar and the model of the guitar.

177
00:10:26,900 --> 00:10:29,090
Then we need the price.

178
00:10:29,090 --> 00:10:33,230
So again pretty much the same thing price.

179
00:10:33,440 --> 00:10:43,000
And then the R&amp;D and the order the purchase order and then item item that P or other.

180
00:10:43,510 --> 00:10:44,960
Okay that is good.

181
00:10:45,050 --> 00:10:52,440
So if we get I don't know maybe 10 articles this will loop the 10 articles it will attach to this template.

182
00:10:52,460 --> 00:10:59,030
You know concatenate this code and that it's going to go right here and the user will get the email

183
00:10:59,060 --> 00:11:00,650
with the correct information.

184
00:11:00,650 --> 00:11:01,660
That is the idea.

185
00:11:01,810 --> 00:11:03,110
So I'm going to save it.

186
00:11:03,540 --> 00:11:04,620
I'm going to go.

187
00:11:04,620 --> 00:11:12,940
Let me just make sure everything is OK looks nice and index that G-mail index sorry action data.

188
00:11:13,010 --> 00:11:14,290
And then we send the data.

189
00:11:14,300 --> 00:11:17,050
So everything look looks really good.

190
00:11:17,240 --> 00:11:18,210
Well let's test it out.

191
00:11:18,230 --> 00:11:20,110
I'm going to go to here.

192
00:11:20,180 --> 00:11:22,960
Can a reload just in case go to home.

193
00:11:23,260 --> 00:11:32,810
I'm going to buy one guitar and maybe a guitar like I like Ivan has his guitar.

194
00:11:32,840 --> 00:11:39,860
I don't know what with Stratocaster you know that they get that particular sound with you Charvel a

195
00:11:39,860 --> 00:11:41,510
real life Charvel.

196
00:11:41,510 --> 00:11:43,580
This one I love this one.

197
00:11:43,610 --> 00:11:43,880
All right.

198
00:11:43,910 --> 00:11:52,070
So now we get a cart sort of server that I can go to the Pay-Pal check out you know the whole process.

199
00:11:52,480 --> 00:12:00,350
It's buyer and then testing one two three Lagann I get to complete the purchase.

200
00:12:00,490 --> 00:12:01,390
So pay now

201
00:12:04,240 --> 00:12:07,010
and then your order is complete.

202
00:12:07,010 --> 00:12:09,270
Let's see if we get an e-mail.

203
00:12:09,370 --> 00:12:10,070
And we do.

204
00:12:10,070 --> 00:12:11,940
Thanks for shopping with us.

205
00:12:12,120 --> 00:12:13,730
Oh and forgot to change this.

206
00:12:13,730 --> 00:12:17,300
Welcome to waves and your purchase information.

207
00:12:17,300 --> 00:12:19,420
Going to check why we are getting nil.

208
00:12:19,790 --> 00:12:21,150
I'm guessing I know why.

209
00:12:21,230 --> 00:12:26,540
And then we get a Fender wrote Kaster price paid and the purchase order and everything else.

210
00:12:26,540 --> 00:12:31,020
So let me let me change the welcome to waves and the no and first thing going to you know possibly Neo

211
00:12:31,030 --> 00:12:33,080
and check why we are getting mil.

212
00:12:33,770 --> 00:12:36,660
I'm pretty sure I know why but I'm going to just going to check it anyways.

213
00:12:38,400 --> 00:12:43,120
Yeah it was this because the first time we are doing this and we don't want it.

214
00:12:43,120 --> 00:12:43,830
All right.

215
00:12:43,840 --> 00:12:47,170
So and then I'm going to change this.

216
00:12:47,170 --> 00:12:48,340
Welcome to waves.

217
00:12:48,430 --> 00:12:50,290
Let me do the word wrap.

218
00:12:50,460 --> 00:12:59,290
And if you're a Mac and used in the via's code the alt not the command the alt and the set or C gets

219
00:12:59,290 --> 00:13:00,430
you the word wrap.

220
00:13:00,790 --> 00:13:01,960
So welcome to waves.

221
00:13:01,990 --> 00:13:02,870
No.

222
00:13:02,890 --> 00:13:03,390
Could be.

223
00:13:03,400 --> 00:13:04,620
Thank you.

224
00:13:05,020 --> 00:13:11,380
Thank you for buying whenever.

225
00:13:12,090 --> 00:13:12,620
Right.

226
00:13:12,790 --> 00:13:17,920
Of course I'm not going to do it again of course because you know we get the information we wanted so

227
00:13:17,920 --> 00:13:20,830
you could attach whatever information you want right here.

228
00:13:20,920 --> 00:13:27,410
Maybe just show one purchase or there because the are all the same and then show all the products again.

229
00:13:27,430 --> 00:13:29,820
It's completely up to you.

230
00:13:30,240 --> 00:13:32,110
OK so just like before.

231
00:13:32,170 --> 00:13:34,690
I'm going to snip everything gave you the code.

232
00:13:34,720 --> 00:13:37,300
And remember that everything is at get have.

