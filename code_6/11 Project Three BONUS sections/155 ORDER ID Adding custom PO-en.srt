1
00:00:01,200 --> 00:00:02,700
OK so now what are we going to be doing.

2
00:00:02,710 --> 00:00:08,080
We're going to be adding purchase or there's an after we do that we will send an email to the user.

3
00:00:08,160 --> 00:00:11,120
So far just to refresh your memory.

4
00:00:11,310 --> 00:00:18,600
If I go to a user and I go to the history we check the history and we get the date of purchase and everything

5
00:00:18,600 --> 00:00:24,780
else and the payment I.D. which is the payment we get from Paypal but maybe we want to create create

6
00:00:25,080 --> 00:00:30,560
our own custom ID for this transaction and not use the one for paypal you know.

7
00:00:30,660 --> 00:00:31,860
So that's what we're going to do.

8
00:00:31,940 --> 00:00:37,460
We're going to create a hash with an I.D. a purchase or ID with hash and everything else.

9
00:00:37,560 --> 00:00:42,900
And then we will store that purchase or their ID inside of the history of the user after they make a

10
00:00:42,900 --> 00:00:43,590
purchase.

11
00:00:43,650 --> 00:00:47,840
And of course we will store that inside the payments document as well.

12
00:00:47,880 --> 00:00:48,350
Right.

13
00:00:48,420 --> 00:00:48,940
OK.

14
00:00:49,440 --> 00:00:53,920
So we can to use a dependency called crypto non-jazz.

15
00:00:53,970 --> 00:00:58,570
If you look for cryptologic as you can find the NPM or the get help.

16
00:00:58,770 --> 00:01:05,430
So we will need to install this dependency to create a hash so we can use the user id to hash something

17
00:01:05,760 --> 00:01:10,080
and it's really simple to use and descriptor Nudgee as it's very very popular.

18
00:01:10,380 --> 00:01:14,190
Real simple right here you have you get some examples in how to use it.

19
00:01:14,400 --> 00:01:21,270
And for example you do you bring the the description you wish and then you just encrypt that is it real

20
00:01:21,270 --> 00:01:22,020
simple.

21
00:01:22,020 --> 00:01:25,540
You get a lot of the types of encryptions right here.

22
00:01:25,920 --> 00:01:29,770
So you can use one you know whenever you want doesn't matter.

23
00:01:30,210 --> 00:01:30,770
OK.

24
00:01:31,020 --> 00:01:32,410
So let's first begin with this.

25
00:01:32,410 --> 00:01:33,910
I'm going to go to the terminal.

26
00:01:33,930 --> 00:01:36,730
Everything was closed the I killed the server and everything else.

27
00:01:36,750 --> 00:01:37,950
So we need to do you.

28
00:01:37,950 --> 00:01:38,550
Yawn.

29
00:01:38,610 --> 00:01:47,440
And of course if you're using NPM NPM installed mine is mine safe at and then it's called crypto jazz

30
00:01:48,000 --> 00:01:56,010
jazz and I'm going to install the version 3 1 9 and then this is the latest version so far.

31
00:01:56,280 --> 00:02:01,400
So going to press center it's going to take a minute and OK everything was installed.

32
00:02:01,540 --> 00:02:06,600
So I'm going to go and double check on the package to Jason.

33
00:02:06,820 --> 00:02:07,990
We've already got it.

34
00:02:07,990 --> 00:02:08,580
Very good.

35
00:02:08,710 --> 00:02:09,250
OK.

36
00:02:09,520 --> 00:02:12,890
So I'm going to close the package adjacent and close everything.

37
00:02:12,890 --> 00:02:18,940
You know we don't need this right now and I'm just going to open the server that is going to go right

38
00:02:18,940 --> 00:02:23,010
here at the top and the first thing we need to do is to include it.

39
00:02:23,020 --> 00:02:26,500
So on the documentation you have the instructions.

40
00:02:26,530 --> 00:02:33,800
So whenever you want to use a type of encryption you need to include just that you don't include everything.

41
00:02:33,820 --> 00:02:38,140
So in this case I'm going to use the Shaw one because it's a very simple encoding.

42
00:02:38,260 --> 00:02:40,630
You can again choose whatever you want.

43
00:02:40,690 --> 00:02:53,340
So Konst going to bring Shaw one equals require open and close and then it's from crypto that jacks

44
00:02:53,380 --> 00:02:55,790
for Slash and that Shaw one.

45
00:02:56,050 --> 00:02:56,880
OK.

46
00:02:57,790 --> 00:02:59,320
So how can how are we going to use it.

47
00:02:59,320 --> 00:03:04,120
How are we going to be creating this purchase or they're going to do it first.

48
00:03:04,240 --> 00:03:10,450
Whenever the service starts I'm going to create revivals right here you know creed the purchase order.

49
00:03:10,450 --> 00:03:12,320
So first I'm going to be using a date.

50
00:03:12,370 --> 00:03:14,380
Of course then we're going to use it on a different place.

51
00:03:14,380 --> 00:03:14,910
Right.

52
00:03:15,060 --> 00:03:21,420
For now just going to just teach you how to use it later.

53
00:03:21,680 --> 00:03:23,160
It will do this correctly.

54
00:03:23,260 --> 00:03:25,390
So first I'm going to bring the date right.

55
00:03:25,840 --> 00:03:30,810
So then what I want to do I went to Crete to purchase or there is going to be equal and I'm going to

56
00:03:30,810 --> 00:03:32,010
use template strings.

57
00:03:32,140 --> 00:03:40,060
So my purchase orders they will start with P O and then dash and then of course I will attach the date

58
00:03:40,210 --> 00:03:42,990
which is you know hash is going to be kind of hash.

59
00:03:43,180 --> 00:03:45,900
It's a set of numbers that you know they are to date.

60
00:03:45,940 --> 00:03:51,980
So we're going to make a reference to date date dot and I'm going to get the seconds.

61
00:03:52,210 --> 00:03:54,410
Remember that this is just kind of an idea.

62
00:03:55,740 --> 00:04:07,320
So then of course first attach the seconds and are going to be attaching date dot and yet get milliseconds.

63
00:04:07,370 --> 00:04:07,710
All right.

64
00:04:07,710 --> 00:04:09,070
This is the only thing I'm going to do.

65
00:04:09,090 --> 00:04:11,520
You can choose whatever you want right here.

66
00:04:11,520 --> 00:04:17,990
You can create your own encryption and then get to the dash open and close and going to use that Shaw

67
00:04:18,110 --> 00:04:18,520
one.

68
00:04:18,560 --> 00:04:21,940
So I'm going to make a reference to Shaw one opening close.

69
00:04:21,960 --> 00:04:27,720
So what I want to use is the idea of the user in this case of course right now we don't have the I.D.

70
00:04:27,900 --> 00:04:32,970
but whenever we make the purchase we will have access to the ID of the user within the route.

71
00:04:32,970 --> 00:04:36,070
So for now I'm just going to do I don't know.

72
00:04:36,600 --> 00:04:37,580
Whatever doesn't matter.

73
00:04:37,590 --> 00:04:44,070
This is going to be the idea of the user will be his word wrap this then what I want to do I want to

74
00:04:44,190 --> 00:04:45,790
of course convert this to strings.

75
00:04:45,780 --> 00:04:49,930
I'm going to say to string open and close and then of course this.

76
00:04:49,930 --> 00:04:51,310
SHAW it.

77
00:04:51,450 --> 00:04:58,020
You know it's going to create like 10 I believe it's more than 10 characters and it's a little bit long.

78
00:04:58,170 --> 00:05:01,200
I don't need more than 10 it's actually much more than 10.

79
00:05:01,230 --> 00:05:06,630
I don't want to attach more than 10 characters right here on this encryption.

80
00:05:06,760 --> 00:05:07,590
So I'm going to do.

81
00:05:07,680 --> 00:05:08,340
I'm just going to do.

82
00:05:08,340 --> 00:05:11,930
Substring and bring the first eight.

83
00:05:12,030 --> 00:05:19,610
So 0 8 and of course when we do Konst.

84
00:05:19,710 --> 00:05:20,320
All right.

85
00:05:20,470 --> 00:05:27,170
So whenever this service starts I want to output this o.

86
00:05:27,900 --> 00:05:29,210
And let's see what we get.

87
00:05:29,620 --> 00:05:30,720
So I'm going to save it.

88
00:05:30,810 --> 00:05:35,100
Of course we need to Yorn Ron dev.

89
00:05:35,650 --> 00:05:40,090
And we should be getting this in a second and right here.

90
00:05:40,120 --> 00:05:41,070
We get it.

91
00:05:41,560 --> 00:05:48,250
So it's P.O. the seconds and the milliseconds you know really really small right here.

92
00:05:48,250 --> 00:05:54,070
Again you can choose whenever you want to create the number or date or you can even get it you know

93
00:05:54,100 --> 00:05:57,440
can be kind of a time stamp but it's going to be much much bigger.

94
00:05:57,500 --> 00:05:58,630
And didn't want that.

95
00:05:58,660 --> 00:06:03,640
And then of course we get Hosh with Shaw one just the first eight characters.

96
00:06:03,640 --> 00:06:06,900
If I don't do this let me just show you.

97
00:06:06,970 --> 00:06:08,250
Going to save it.

98
00:06:08,340 --> 00:06:10,000
The hash is no.

99
00:06:10,060 --> 00:06:14,080
3 to Preter Bik much more than 10 characters.

100
00:06:14,090 --> 00:06:14,830
All right.

101
00:06:15,230 --> 00:06:17,020
So this is what we're going to be using.

102
00:06:17,030 --> 00:06:17,750
All right.

103
00:06:17,750 --> 00:06:25,100
So I'm going to I'm going to kind of a calm in this because we need to create this logic within the

104
00:06:25,130 --> 00:06:27,580
correct route whenever we make a purchase.

105
00:06:27,590 --> 00:06:34,010
We will create a purchase order with the user information and then you know pass it to the stored inside

106
00:06:34,010 --> 00:06:34,720
Mongo.

107
00:06:35,000 --> 00:06:36,740
So we're going to be doing this.

108
00:06:36,980 --> 00:06:38,500
Well I got a copy of this.

109
00:06:38,530 --> 00:06:41,190
You know use it in the second is going to copy.

110
00:06:41,450 --> 00:06:45,450
I'm going to go to the correct route and it's at the card.

111
00:06:45,740 --> 00:06:47,760
No it's success mine.

112
00:06:47,900 --> 00:06:54,100
So whenever we make a success by we will generate the correct number right.

113
00:06:54,130 --> 00:06:57,080
So I'm going to go right here.

114
00:06:57,470 --> 00:07:03,320
I'm going to pretty much do the same logic logic going to attach everything create the deck get the

115
00:07:03,320 --> 00:07:06,760
date and then get the O.

116
00:07:06,920 --> 00:07:09,560
Now remember we are using the mouse middleware.

117
00:07:09,740 --> 00:07:15,050
So instead of here we have access to request that user ID.

118
00:07:15,110 --> 00:07:23,630
So instead of just passing this I'm going to say request that user that underscore ID.

119
00:07:23,930 --> 00:07:28,440
So this will create a hash with the date and the user ID.

120
00:07:28,520 --> 00:07:29,180
Very good.

121
00:07:29,390 --> 00:07:30,240
All right.

122
00:07:30,560 --> 00:07:36,720
So now we need to attach this purchase order inside of the history of the user whenever they make a

123
00:07:36,720 --> 00:07:42,950
purchase and then we need to add it to transaction data so we can store for it in site payments.

124
00:07:43,100 --> 00:07:45,620
Right because it's same purchase order number.

125
00:07:45,680 --> 00:07:50,570
So we're going to go right here to say p order you can call this whatever you want.

126
00:07:50,570 --> 00:07:54,610
And there's one it's going to be equal to PTO to this viable.

127
00:07:54,660 --> 00:08:00,650
Right now we pretty much need to do the same thing with different section data with this one is going

128
00:08:00,650 --> 00:08:01,870
to go right here.

129
00:08:01,940 --> 00:08:06,370
So I want to include this inside of the payment data.

130
00:08:06,500 --> 00:08:09,490
So we're going to bring object notation.

131
00:08:09,590 --> 00:08:16,070
Okay instead of this object I want to add everything that side requires that body the payment data which

132
00:08:16,070 --> 00:08:19,010
is you know pay pal information and then coma.

133
00:08:19,010 --> 00:08:24,070
And I also want the pre order and the P or there it's equal to.

134
00:08:24,110 --> 00:08:24,800
Oh.

135
00:08:25,490 --> 00:08:27,460
All right.

136
00:08:27,580 --> 00:08:27,820
All right.

137
00:08:27,820 --> 00:08:28,900
Looks nice.

138
00:08:28,900 --> 00:08:30,910
And that's pretty much it.

139
00:08:30,940 --> 00:08:38,710
Whenever we stored the information inside our database they will get the pre order the purchase or inside

140
00:08:38,710 --> 00:08:42,570
of the user with the history and inside of the transaction data.

141
00:08:42,580 --> 00:08:43,230
All right.

142
00:08:43,240 --> 00:08:46,180
And later much later we're going to send an e-mail.

143
00:08:46,180 --> 00:08:49,540
But first let's see if this works.

144
00:08:49,540 --> 00:08:50,070
All right.

145
00:08:50,330 --> 00:08:51,340
I'm going to go here.

146
00:08:51,490 --> 00:08:53,100
Reload the application.

147
00:08:53,440 --> 00:08:55,630
We already have an item right here.

148
00:08:55,750 --> 00:08:58,880
So I'm going to go to pay pal.

149
00:08:59,020 --> 00:09:07,820
I'm going to use my testing account buyer and I don't remember the past where a thing was testing one

150
00:09:07,830 --> 00:09:10,890
two three.

151
00:09:11,440 --> 00:09:12,940
I'm not sure.

152
00:09:13,540 --> 00:09:13,850
Yeah.

153
00:09:13,880 --> 00:09:23,050
Get our.

154
00:09:23,210 --> 00:09:23,510
All right.

155
00:09:23,510 --> 00:09:25,260
So I'm going to complete the purchase.

156
00:09:25,370 --> 00:09:26,610
I'm going to pay now.

157
00:09:29,350 --> 00:09:30,830
And everything is OK.

158
00:09:31,090 --> 00:09:35,960
So now of course if you go to account we have this history and this is something that we need to change.

159
00:09:36,070 --> 00:09:37,280
I went to change the date.

160
00:09:37,340 --> 00:09:43,360
Date of purchase for the P or they're going to do this in a second but first I want to check on our

161
00:09:43,360 --> 00:09:47,610
project to check if everything it's ok inside users.

162
00:09:47,740 --> 00:09:54,820
So I'm going to France is the Joan JONES We have this history and we get the order and same thing with

163
00:09:54,830 --> 00:09:55,590
payments.

164
00:09:55,590 --> 00:10:01,580
You have a new payment with the data and the Order of you know same ID.

165
00:10:01,760 --> 00:10:03,240
So good.

166
00:10:03,640 --> 00:10:08,200
So now what I need to do I need to change the date of purchase for the PPI or other.

167
00:10:08,520 --> 00:10:11,970
Oh let's go to our application inside client.

168
00:10:12,010 --> 00:10:17,660
Remember we have this dashboard inside user and then index and we have the history block.

169
00:10:17,890 --> 00:10:23,980
So we're going to open a history block does it cause us and insight of the history block.

170
00:10:24,040 --> 00:10:24,870
Very simple.

171
00:10:24,880 --> 00:10:29,440
Instead of using moment and date of purchase and everything else are just going to output the product

172
00:10:29,730 --> 00:10:35,670
or they're so closet product that P or other.

173
00:10:35,770 --> 00:10:38,630
Now there is no reason to use moment.

174
00:10:38,980 --> 00:10:44,040
I'm going to I'm going to do this because again this this will go to you.

175
00:10:44,200 --> 00:10:50,800
So we're going to I'm going to copy this code because maybe you don't remember how to use movement and

176
00:10:51,700 --> 00:11:03,180
this one you know will be in light you are going to delete this and then product per adult dot and then.

177
00:11:03,400 --> 00:11:07,320
Or their P or other.

178
00:11:07,420 --> 00:11:08,100
All right.

179
00:11:08,110 --> 00:11:12,490
And that is it of course we need to change this with the I don't know or there are a number make sense

180
00:11:13,180 --> 00:11:18,730
or there or there are a number.

181
00:11:18,730 --> 00:11:19,200
Very good.

182
00:11:19,210 --> 00:11:20,680
Let me delete the last.

183
00:11:20,720 --> 00:11:23,220
Th.

184
00:11:23,500 --> 00:11:24,060
All right.

185
00:11:24,130 --> 00:11:29,110
So now of course you reload the application can it get it or the number and then the P.

186
00:11:29,770 --> 00:11:30,430
Very good.

187
00:11:30,610 --> 00:11:37,180
I'm deleting the date because if not begin to get a lot of things here let's get it get really crowded

188
00:11:37,270 --> 00:11:40,910
and I don't want that but again you wanted to keep the date.

189
00:11:40,930 --> 00:11:41,450
You can do it.

190
00:11:41,470 --> 00:11:42,430
No problem.

191
00:11:42,840 --> 00:11:43,210
All right.

192
00:11:43,240 --> 00:11:45,500
So everything is good here.

193
00:11:45,850 --> 00:11:47,830
So we are pretty much done with this.

194
00:11:47,860 --> 00:11:53,210
We're going to go to the next section of this bonus and we will send in e-mail.

195
00:11:53,230 --> 00:11:55,980
And we already have the logic for sending e-mails.

196
00:11:56,020 --> 00:11:57,520
We just need to call that function.

197
00:11:57,520 --> 00:11:59,110
We've included Now the tab.

198
00:11:59,260 --> 00:12:03,290
But the problem is that right now we just get one template.

199
00:12:03,310 --> 00:12:04,910
This is the only thing we get.

200
00:12:05,080 --> 00:12:09,490
So we're going to add a new template with all the logic to showing that the order.

