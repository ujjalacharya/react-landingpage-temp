1
00:00:00,540 --> 00:00:01,040
Right.

2
00:00:01,060 --> 00:00:05,690
So back on the index I'm going to get this and going to make a request to X-post.

3
00:00:05,920 --> 00:00:08,250
I believe we've imported this at the top.

4
00:00:08,300 --> 00:00:10,830
X-posts kind of don't remember.

5
00:00:10,840 --> 00:00:12,400
So we went with it.

6
00:00:12,690 --> 00:00:15,220
Then of course this is going to be a POST request.

7
00:00:15,250 --> 00:00:19,970
Open it close get it copy the route API user I make it.

8
00:00:19,980 --> 00:00:24,250
Users just like the other ones recent user right.

9
00:00:24,730 --> 00:00:27,950
And then of course we put the location right here.

10
00:00:28,040 --> 00:00:31,700
Koma we pass the data to see if made with the email.

11
00:00:31,720 --> 00:00:34,510
And then of course we do something right.

12
00:00:34,870 --> 00:00:41,800
The den open and close we send the response with something else very good.

13
00:00:41,800 --> 00:00:45,370
Now remember that the server will be returning success.

14
00:00:45,430 --> 00:00:47,720
True or no success false.

15
00:00:47,830 --> 00:00:59,410
So of course if we get a response response that data does success of true then I can do this.

16
00:00:59,410 --> 00:01:08,130
That said state this that set stayed open and close and save form success.

17
00:01:08,190 --> 00:01:08,900
True.

18
00:01:08,920 --> 00:01:11,770
So we can you know get the message right here.

19
00:01:11,820 --> 00:01:15,200
Former success right here at the bottom we get the from success.

20
00:01:15,260 --> 00:01:16,310
I'm not going to do the form.

21
00:01:16,390 --> 00:01:17,610
You can do it if you wish.

22
00:01:17,650 --> 00:01:20,780
If you get of course a different response you can attach the.

23
00:01:20,790 --> 00:01:26,140
You know please you know the email isn't correct or this e-mail is not a database just going to skip

24
00:01:26,140 --> 00:01:28,660
it to save some time because it's pretty simple.

25
00:01:28,660 --> 00:01:31,710
So now of course we're going to make a request and we can set the token.

26
00:01:31,750 --> 00:01:38,310
Let's see if this works the application and I'm using the Franz's that Jones that rep.

27
00:01:38,620 --> 00:01:45,090
So Francis Jones that BRAF are going to send the email and done check your e-mail.

28
00:01:45,090 --> 00:01:45,970
All right.

29
00:01:46,240 --> 00:01:53,300
So I'm going to go to users going to Frances and we get the research token so that it's working.

30
00:01:53,320 --> 00:01:54,400
All right.

31
00:01:54,400 --> 00:01:59,560
So now we have one more thing we need said the you know the date for that token the expiration date.

32
00:01:59,560 --> 00:02:00,020
All right.

33
00:02:00,220 --> 00:02:02,590
So let's go back to user.

34
00:02:02,820 --> 00:02:04,410
Are we going to do it right here.

35
00:02:04,420 --> 00:02:06,240
Can it create a date and store it.

36
00:02:06,250 --> 00:02:08,740
Now the thing is that we need a couple of things.

37
00:02:08,740 --> 00:02:10,330
So we need to day stay.

38
00:02:10,510 --> 00:02:12,340
And again to set it for to morrow.

39
00:02:12,340 --> 00:02:15,630
So my token is going to last one day.

40
00:02:15,640 --> 00:02:21,430
Now what I'm going to do I'm going to send the token to the beginning of the date and the end of that

41
00:02:21,430 --> 00:02:25,450
token when it will expire it's the end of the date.

42
00:02:25,450 --> 00:02:32,620
So if we are you know we are entering we are requesting the password right now is going to be the whole

43
00:02:32,680 --> 00:02:34,200
day of today.

44
00:02:34,330 --> 00:02:34,570
Right.

45
00:02:34,570 --> 00:02:36,710
And going to do it like this like this.

46
00:02:36,730 --> 00:02:37,750
You can do whatever you want.

47
00:02:37,750 --> 00:02:42,340
You can create a time stamp that starts right now and it will expire in two hours.

48
00:02:42,340 --> 00:02:43,670
Depends on your logic.

49
00:02:43,840 --> 00:02:45,670
Just going to do it just like that.

50
00:02:45,690 --> 00:02:48,410
You know it starts today and ends today.

51
00:02:48,460 --> 00:02:53,970
So I'm going to create a viable call today equals and we need to use moment.

52
00:02:54,040 --> 00:02:55,700
I'm not sure we have it at the top.

53
00:02:55,720 --> 00:02:56,380
No we don't.

54
00:02:56,380 --> 00:02:57,820
I'm going to include it.

55
00:02:57,970 --> 00:03:00,860
So I'm going to do it right here.

56
00:03:01,300 --> 00:03:07,990
So Konst moment calls require that open close.

57
00:03:08,200 --> 00:03:15,970
And you know moment now we do have this installed we installed this moment I'm using the to that 22

58
00:03:16,000 --> 00:03:19,740
that to see if you didn't install this version.

59
00:03:19,850 --> 00:03:21,260
All right let's go back to user.

60
00:03:21,380 --> 00:03:23,120
So woman's right.

61
00:03:23,130 --> 00:03:29,970
So now I'm going to go right here and say OK so what I want to do I want to get today's date.

62
00:03:30,080 --> 00:03:38,600
But the starting of today's date is going to say moments dot and we have a method called Start off.

63
00:03:38,870 --> 00:03:45,920
And when we say we start off this date and now if you do it like this we can get the date like a more

64
00:03:45,920 --> 00:03:46,660
readable date.

65
00:03:46,670 --> 00:03:48,350
But I want to get just the numbers.

66
00:03:48,380 --> 00:03:53,750
You know just like a timestamp timestamp so we get the value off and we get that number.

67
00:03:54,130 --> 00:04:01,160
Now I need to get you know the date of to morrow because to date this do it today it's not going to

68
00:04:01,160 --> 00:04:06,220
be setting on the receipt token we set the expiration date so the expiration date.

69
00:04:06,320 --> 00:04:12,410
It's to morrow I'm bringing this so I can create that to morrow Barville you can see it right now.

70
00:04:12,410 --> 00:04:17,960
So tomorrow equals pretty much the same thing than this.

71
00:04:18,020 --> 00:04:19,250
You know the same thing.

72
00:04:19,430 --> 00:04:22,300
But I'm going to be passing that today instead of moment.

73
00:04:22,350 --> 00:04:30,620
So we will calculate the end of this date starting from today and then instead of say start off we say

74
00:04:30,680 --> 00:04:36,160
and off and this will give us the end of today.

75
00:04:36,380 --> 00:04:37,210
Right.

76
00:04:37,250 --> 00:04:40,310
I told you it was going to weird but you know it makes sense.

77
00:04:40,310 --> 00:04:48,110
So now whenever we get the to morrow date with the value of we say user and I believe it was a token

78
00:04:48,310 --> 00:04:49,490
XP.

79
00:04:49,580 --> 00:04:52,960
So this one it's equal to tomorrow.

80
00:04:53,480 --> 00:04:54,590
All right.

81
00:04:55,160 --> 00:04:57,890
So now on the server we don't need to do anything else.

82
00:04:57,890 --> 00:05:03,920
We need to try and check if we get that the data are going to read the application are going to go to

83
00:05:03,920 --> 00:05:08,140
Francis reset password and check it on the database.

84
00:05:08,210 --> 00:05:12,320
And now we get you know tomorrows data actually today at the end of today.

85
00:05:12,470 --> 00:05:13,570
And the reset token.

86
00:05:13,640 --> 00:05:20,270
So we pretty much have everything we need now the next step is going to be sending an e-mail to the

87
00:05:20,270 --> 00:05:21,150
user.

88
00:05:21,350 --> 00:05:22,190
Of course.

89
00:05:22,280 --> 00:05:26,000
So they can you know get the token and the like.

90
00:05:26,000 --> 00:05:26,370
All right.

91
00:05:26,510 --> 00:05:33,050
So let's kind of do it right now so I can go right here and say All right.

92
00:05:33,350 --> 00:05:38,070
So if everything goes OK I'm going to send an e-mail if you remember we need the e-mail.

93
00:05:38,090 --> 00:05:45,770
The user name the token which in this case is going to be no again the type of the template and then

94
00:05:45,860 --> 00:05:47,190
the data we want to send.

95
00:05:47,210 --> 00:05:47,780
All right.

96
00:05:48,080 --> 00:05:49,270
So send e-mail.

97
00:05:49,340 --> 00:05:52,350
First one is the user not e-mail.

98
00:05:52,400 --> 00:05:53,170
Right.

99
00:05:53,180 --> 00:05:56,190
The second one its user name.

100
00:05:56,270 --> 00:05:58,540
And now I'm doing this all arguments.

101
00:05:58,590 --> 00:06:01,280
You can do is just create one and send that Jason.

102
00:06:01,320 --> 00:06:01,650
Right.

103
00:06:01,670 --> 00:06:04,100
You can do that pretty much the same thing.

104
00:06:04,100 --> 00:06:07,690
Then I'm going to say no than a coma and I get to create a template.

105
00:06:07,700 --> 00:06:09,010
We didn't have this template.

106
00:06:09,230 --> 00:06:10,670
It's a reset password.

107
00:06:10,670 --> 00:06:14,450
We're going to create it right in a couple minutes and then I'm going to be passing more information

108
00:06:14,450 --> 00:06:19,740
because whenever we send e-mail we need to get the token that we are generating right here.

109
00:06:19,790 --> 00:06:21,520
So we need to pass this on.

110
00:06:21,540 --> 00:06:25,560
All this is inside the user document which is more modified.

111
00:06:25,610 --> 00:06:30,940
So if you remember the last argument could be an object with a lot of things.

112
00:06:31,220 --> 00:06:33,560
So this case is going to be just the user data.

113
00:06:33,590 --> 00:06:35,010
All right.

114
00:06:35,090 --> 00:06:37,790
So let's go to the send email function.

115
00:06:37,790 --> 00:06:42,630
Right so I'm going to go to you Tilse male male and the main index.

116
00:06:42,770 --> 00:06:47,330
We do have the welcome and the purchase and everything else stays the same because you know at this

117
00:06:47,330 --> 00:06:50,600
point we pretty much everything we need.

118
00:06:50,600 --> 00:06:51,360
All right.

119
00:06:51,880 --> 00:06:52,560
OK.

120
00:06:52,760 --> 00:06:55,530
So we get a case with welcome purchase.

121
00:06:55,550 --> 00:06:57,800
So we need to add a new case Ryan.

122
00:06:58,100 --> 00:07:03,340
So case opening close and we called this case reset password.

123
00:07:03,530 --> 00:07:11,900
So the case is reset passport go and say data data equals an object and then never forget to do the

124
00:07:11,900 --> 00:07:13,280
break.

125
00:07:13,280 --> 00:07:14,510
All right.

126
00:07:14,510 --> 00:07:16,870
So the data is pretty much just like this one.

127
00:07:16,940 --> 00:07:18,610
Of course we're going to change things.

128
00:07:18,610 --> 00:07:23,590
It's from waves the two still the two and we need to change something here.

129
00:07:23,630 --> 00:07:25,760
We're going to say I don't know.

130
00:07:25,760 --> 00:07:26,550
Hey.

131
00:07:26,730 --> 00:07:35,040
And the name of the user that reset just some like like here your pass whatever.

132
00:07:35,040 --> 00:07:36,770
Now of course we cannot use this template.

133
00:07:36,770 --> 00:07:38,980
We need to create one on a new one.

134
00:07:39,110 --> 00:07:45,000
So I'm going to call it reset pass and we're going to still pass the actual data which contains the

135
00:07:45,000 --> 00:07:47,450
token of course the user with the token.

136
00:07:47,450 --> 00:07:47,880
All right.

137
00:07:47,900 --> 00:07:50,400
So we're going to read the template right here.

138
00:07:50,430 --> 00:07:57,030
We're going to parse the BDO bring the HVM else so we can take a look at that and then it come back.

139
00:07:57,620 --> 00:07:57,920
OK.

140
00:07:57,920 --> 00:07:59,360
So this is how it's going to look.

141
00:07:59,360 --> 00:08:03,240
Remember I've gave us a resource that we use the past template to map.

142
00:08:03,500 --> 00:08:05,720
So click the link to reset a password.

143
00:08:05,750 --> 00:08:10,040
And whenever we click it we go to our application with the token.

144
00:08:10,220 --> 00:08:10,570
Right.

145
00:08:10,670 --> 00:08:10,970
OK.

146
00:08:10,970 --> 00:08:12,370
So let's do it right now.

147
00:08:12,530 --> 00:08:20,210
Are going to go to mail and creating new file and call it the same way we said past underscore.

148
00:08:20,320 --> 00:08:20,600
Sorry.

149
00:08:20,610 --> 00:08:21,010
Yeah.

150
00:08:21,250 --> 00:08:21,850
Pass.

151
00:08:21,910 --> 00:08:22,320
Yeah.

152
00:08:22,730 --> 00:08:26,090
And then template that javascript.

153
00:08:26,340 --> 00:08:27,470
Right.

154
00:08:27,620 --> 00:08:31,200
Of course this one just like the other ones is going to be just a function.

155
00:08:31,250 --> 00:08:41,540
So Konst reset pass equals opening close and we run some things and at the end we will return some templates.

156
00:08:41,720 --> 00:08:42,370
Right.

157
00:08:42,740 --> 00:08:44,240
So of course we need to export it.

158
00:08:44,270 --> 00:08:52,790
So a module that exports equals and then reset pass reset pass.

159
00:08:52,820 --> 00:08:53,250
All right.

160
00:08:53,250 --> 00:08:54,350
Not give me the option.

161
00:08:54,350 --> 00:08:57,090
So we said pass.

162
00:08:57,120 --> 00:08:57,810
All right.

163
00:08:57,990 --> 00:09:04,090
I'm going to make it a capital P Ryan a little bit better.

164
00:09:04,410 --> 00:09:05,060
OK.

165
00:09:05,520 --> 00:09:06,930
So we do have a function.

166
00:09:06,960 --> 00:09:11,800
And remember that this function will be we will be getting some data.

167
00:09:11,850 --> 00:09:18,330
So what we need to be we turning inside of here it's the templates Angelico copy the whole template

168
00:09:18,510 --> 00:09:19,830
and paste it.

169
00:09:19,930 --> 00:09:20,430
All right.

170
00:09:20,430 --> 00:09:23,820
And I'm going to order this a little bit.

171
00:09:23,850 --> 00:09:24,510
All right.

172
00:09:24,690 --> 00:09:31,030
So now if you if you notice maybe you noticed already we have a tiny tiny problem.

173
00:09:31,110 --> 00:09:36,970
What we need to do we need to pass a link right here reset the passport arrived.

174
00:09:36,990 --> 00:09:40,410
So for example I'm going to enter here I'm going to say all right.

175
00:09:40,410 --> 00:09:44,370
So what we need to do on the Tref we need to pass.

176
00:09:44,400 --> 00:09:48,400
We need to go to local host whatever whatever.

177
00:09:48,720 --> 00:09:49,920
Right host.

178
00:09:50,000 --> 00:09:52,390
Eighty three thousand actually.

179
00:09:52,980 --> 00:09:56,990
And then for Slash and we're going to go to a route called Reset passport.

180
00:09:57,210 --> 00:09:59,520
We don't have this route when we do this.

181
00:09:59,550 --> 00:10:05,940
The word wrap we're going to go to reset password for Slash and we're going to be passing the token

182
00:10:05,940 --> 00:10:15,180
we get from data and then reset and then tokin right to pretty up is the problem right here is the local

183
00:10:15,180 --> 00:10:16,480
host.

184
00:10:16,830 --> 00:10:22,280
How can we tell the application that we need to go to local host or wherever you are.

185
00:10:22,290 --> 00:10:25,250
All we have inside production right.

186
00:10:25,350 --> 00:10:29,110
Because you know this is what can happen if I go and put local host.

187
00:10:29,130 --> 00:10:32,050
The user will get an email going to localhost.

188
00:10:32,310 --> 00:10:32,890
All right.

189
00:10:33,110 --> 00:10:36,360
So we're going to go at the top right here.

190
00:10:36,400 --> 00:10:42,690
Going to go and just create a function that Barville that's going to be deciding where are we going

191
00:10:42,690 --> 00:10:43,170
to be going.

192
00:10:43,170 --> 00:10:47,380
So Konst you r l e course.

193
00:10:47,460 --> 00:10:54,150
Now what I want to check it's to check the process if the process and can did this on under a different

194
00:10:54,150 --> 00:10:54,910
section.

195
00:10:55,020 --> 00:11:03,510
If the process equals to note underscore EMV and it's equal to production we can do something.

196
00:11:03,510 --> 00:11:04,260
Let me do it right.

197
00:11:04,260 --> 00:11:11,270
Production we're going to do something if not we're going to do something else.

198
00:11:11,520 --> 00:11:12,800
So that's something else.

199
00:11:12,810 --> 00:11:18,610
If it's not equal to production if you're not inside production you're going to say OK so this is development.

200
00:11:18,720 --> 00:11:28,700
So we're going to do the DTP HGT pecan for Slash for Slash local host three thousand whatever your environment

201
00:11:28,740 --> 00:11:30,790
your testing environment is.

202
00:11:30,870 --> 00:11:36,030
If not we need to pass the u r l of the production.

203
00:11:36,150 --> 00:11:38,850
Well we're in the testing mode.

204
00:11:38,850 --> 00:11:40,000
You will need to do something else.

205
00:11:40,020 --> 00:11:45,980
But you know at the end when the application goes live you can have your your out your final your elf

206
00:11:45,980 --> 00:11:49,770
horse so we can store this inside the embarkment virals.

207
00:11:49,860 --> 00:11:57,150
So I'm going to say process dot D-NV dot and I'm going to college route you are l.

208
00:11:57,300 --> 00:12:05,020
We don't have this in a copy and go to the environment virals going to say that they're route you are

209
00:12:05,020 --> 00:12:13,590
l is going to know it's going to be I don't know HTP for Slash forward slash and then waves dot com

210
00:12:13,950 --> 00:12:15,450
whatever.

211
00:12:15,450 --> 00:12:22,770
Now remember that if you're adding this to the environment virals on the development place of the development

212
00:12:22,860 --> 00:12:29,070
environment you will need whenever you go to production go to the configuration of Heroku and you know

213
00:12:29,120 --> 00:12:32,260
add them if not of course nothing is going to work.

214
00:12:33,090 --> 00:12:34,810
So now we have the route you are l.

215
00:12:34,920 --> 00:12:39,540
But what we need to do is to include that dot and beaches like that with a server.

216
00:12:39,600 --> 00:12:45,740
So I'm going to copy this and I'm going to go right here at the top and paste it.

217
00:12:45,770 --> 00:12:46,970
All right.

218
00:12:47,550 --> 00:12:52,740
So now inside of this file we have access to this Eurail which is going to be equal to whatever we get

219
00:12:52,770 --> 00:12:59,300
inside the rural with that M-B or is going to be equal to localhost three thousand.

220
00:12:59,460 --> 00:13:00,350
This one.

221
00:13:00,420 --> 00:13:01,130
All right.

222
00:13:01,440 --> 00:13:07,570
So instead of putting the address you know the domain just like this I'm going to say just you are Apple

223
00:13:08,010 --> 00:13:13,620
and it's going to go to whatever you are you are you are using recent passport and it will attach that

224
00:13:13,620 --> 00:13:15,970
data token.

225
00:13:15,980 --> 00:13:16,920
All right.

226
00:13:16,920 --> 00:13:18,210
So this looks nice.

227
00:13:18,310 --> 00:13:21,090
No mistakes hopefully no mistakes.

228
00:13:21,090 --> 00:13:26,150
So now what we need to do right here we need we are making a reference to recent past.

229
00:13:26,220 --> 00:13:35,940
But we are not including this at the top so Konst opening close recent past re Choire that forward slash

230
00:13:36,330 --> 00:13:42,420
and reset pass template so now it's going to work.

231
00:13:42,870 --> 00:13:43,720
OK.

232
00:13:44,120 --> 00:13:46,940
So we are ready to try it and see what happens.

233
00:13:47,280 --> 00:13:49,890
I'm going to go and reset the Jones wrap.

234
00:13:49,960 --> 00:13:51,560
Can it reset the passport.

235
00:13:51,560 --> 00:13:51,890
Done.

236
00:13:51,890 --> 00:13:53,080
Check your e-mail.

237
00:13:53,120 --> 00:13:55,090
And if we check the e-mails.

238
00:13:55,460 --> 00:13:56,180
Hey Francis.

239
00:13:56,180 --> 00:13:58,760
Reset your pass get the link.

240
00:13:58,790 --> 00:14:03,290
And if I go here we go to a local host reset password and a token.

241
00:14:03,290 --> 00:14:07,830
Now of course we are getting page not found because we need to create this route.

242
00:14:07,850 --> 00:14:09,840
This is the next step.

243
00:14:09,840 --> 00:14:13,500
And on this route we will have two different things.

244
00:14:13,490 --> 00:14:19,730
And you know the two different inputs the password and the you know confirm password if the passwords

245
00:14:19,760 --> 00:14:26,140
are good that we're going to go back to the server check if this token it's correct and it's not expired.

246
00:14:26,240 --> 00:14:31,470
And if everything is OK we're going to reset the password right and let the user move forward.

247
00:14:31,820 --> 00:14:34,020
So that is what we need to do right now.

248
00:14:34,100 --> 00:14:36,680
Let's go to the next section and complete this.

